(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{264:function(e,t,a){e.exports=a.p+"assets/img/dic.2bc6e02a.png"},265:function(e,t,a){e.exports=a.p+"assets/img/opcitemsconfig.b6ea3aa0.png"},266:function(e,t,a){e.exports=a.p+"assets/img/execonfig.8ab5bc3d.png"},267:function(e,t,a){e.exports=a.p+"assets/img/exe.985d8b95.png"},268:function(e,t,a){e.exports=a.p+"assets/img/log.20aedb4d.png"},375:function(e,t,a){"use strict";a.r(t);var i=a(2),r=Object(i.a)({},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",{attrs:{id:"dxopc-ole-client使用说明"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client使用说明","aria-hidden":"true"}},[e._v("#")]),e._v(" DXOPC_OLE_Client使用说明")]),e._v(" "),i("p",[e._v("DXOPC_OLE_Client是以自动化接口方式取OPC内数据实时入库的工具。数据库支持SQL Server、Oracle。"),i("br"),e._v("\n入库方式有2种推荐第一种，环节越少使用越简单:")]),e._v(" "),i("ol",[i("li",[e._v("获取到的数据可以直接入目标库。")]),e._v(" "),i("li",[e._v("若目标库无法通过网络直接访问，使用配套webservice中转入库。")])]),e._v(" "),i("h2",{attrs:{id:"运行环境"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#运行环境","aria-hidden":"true"}},[e._v("#")]),e._v(" 运行环境")]),e._v(" "),i("p",[e._v(".NET4.0，百度网盘"),i("a",{attrs:{href:"https://pan.baidu.com/s/1AvCoP826CS9xipfSv-0aOw",target:"_blank",rel:"noopener noreferrer"}},[e._v("下载"),i("OutboundLink")],1),e._v("，提取码：8yqp")]),e._v(" "),i("h2",{attrs:{id:"目录结构"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#目录结构","aria-hidden":"true"}},[e._v("#")]),e._v(" 目录结构")]),e._v(" "),i("p",[e._v("主目录"),i("br"),e._v(" "),i("img",{attrs:{src:a(264),alt:"dic"}})]),e._v(" "),i("h2",{attrs:{id:"应用配置"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#应用配置","aria-hidden":"true"}},[e._v("#")]),e._v(" 应用配置")]),e._v(" "),i("h3",{attrs:{id:"opcitemsconfig-xml配置"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#opcitemsconfig-xml配置","aria-hidden":"true"}},[e._v("#")]),e._v(" OPCItemsConfig.xml配置")]),e._v(" "),i("p",[i("img",{attrs:{src:a(265),alt:"opcitemsconfig"}})]),e._v(" "),i("ol",[i("li",[e._v("OpcItems标签说明：\n"),i("ul",[i("li",[e._v("serverIp：OPC SERVER的IP")]),e._v(" "),i("li",[e._v("opcLibrary：OPC SERVER的服务标识"),i("br"),e._v(" "),i("strong",[e._v("这两个参数组态调试人员提供")])]),e._v(" "),i("li",[e._v("targetDbType：目标数据库类型，SQLSERVER或ORACLE")]),e._v(" "),i("li",[e._v("upstreamType：上层服务类型，DB或WebService。eg:直接入库的形式配DB")])])]),e._v(" "),i("li",[e._v("OpcItem标签说明：\n"),i("ul",[i("li",[e._v("clientHandle：客户端自定义变量标识，从1递增即可")]),e._v(" "),i("li",[e._v("itemId：服务端内部变量标识，"),i("strong",[e._v("组态调试人员提供")])]),e._v(" "),i("li",[e._v("itemValue：变量值")]),e._v(" "),i("li",[e._v("itemQuality：质量")]),e._v(" "),i("li",[e._v("itemTimeStamp：时间戳")]),e._v(" "),i("li",[e._v("dataType：数据类型标识，用于计算量，不需要的不用配置")]),e._v(" "),i("li",[e._v("dataType2：数据类型标识，用于计算量，不需要的不用配置")]),e._v(" "),i("li",[e._v("targetTable：目标表名")]),e._v(" "),i("li",[e._v("targetColumn： 目标列名")]),e._v(" "),i("li",[e._v("targetTablePk：目标表主键字段名，只支持单主键")]),e._v(" "),i("li",[e._v("targetPkValue：主键值")]),e._v(" "),i("li",[e._v("sjColumn：数据时间字段名"),i("br"),e._v(" "),i("strong",[e._v("OpcItem的配置可以从配置文件手动配，也可以从程序界面上配置。配置文件更改后需要重启程序。")])])])])]),e._v(" "),i("h3",{attrs:{id:"dxopcinteractive-exe-config配置"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#dxopcinteractive-exe-config配置","aria-hidden":"true"}},[e._v("#")]),e._v(" DxOPCInteractive.exe.config配置")]),e._v(" "),i("p",[i("img",{attrs:{src:a(266),alt:"execonfig"}})]),e._v(" "),i("ol",[i("li",[e._v("connectionStrings：数据库连接配置，ConnectionString是SQL SERVER的配置，ConnectionString_ORACLE是ORACLE的配置")]),e._v(" "),i("li",[e._v("client：对应上层webservice的地址")])]),e._v(" "),i("h3",{attrs:{id:"界面应用"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#界面应用","aria-hidden":"true"}},[e._v("#")]),e._v(" 界面应用")]),e._v(" "),i("p",[i("img",{attrs:{src:a(267),alt:"exe"}}),i("br"),e._v("\nAddItem：增加变量"),i("br"),e._v("\nDeleteItem：删除变量"),i("br"),e._v("\n变量配置：直接更改相应属性，所在行失去焦点时自动保存"),i("br"),e._v("\n变量调试：Read、Write读写变量，Read时需要clientHandle参数，Write时需要itemValue参数"),i("br"),e._v("\neg：上图中配置了1个变量，从OPC服务中取aliasgroup1.TAG1的值，更新到a表中主键字段c值为d的记录的b字段上。")]),e._v(" "),i("h3",{attrs:{id:"日志"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#日志","aria-hidden":"true"}},[e._v("#")]),e._v(" 日志")]),e._v(" "),i("p",[i("img",{attrs:{src:a(268),alt:"log"}}),i("br"),e._v("\n在bin目录同级，DxOPCInteractive_log.txt是日志文件")]),e._v(" "),i("h2",{attrs:{id:"配套webservice"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#配套webservice","aria-hidden":"true"}},[e._v("#")]),e._v(" 配套webservice")]),e._v(" "),i("ol",[i("li",[e._v("IIS内发布dataProcWebService服务，保证网络通信正常。")]),e._v(" "),i("li",[e._v("Web.config配置目标数据库连接字符串，ConnectionString是SQL SERVER的配置，OraConnectionString是ORACLE的配置。")]),e._v(" "),i("li",[e._v("浏览器内访问服务地址没有报错，一般就是正常的。")])])])},[],!1,null,null,null);t.default=r.exports}}]);