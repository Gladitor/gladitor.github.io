(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{264:function(t,e,r){t.exports=r.p+"assets/img/dic.2bc6e02a.png"},265:function(t,e,r){t.exports=r.p+"assets/img/opcitemsconfig.b6ea3aa0.png"},266:function(t,e,r){t.exports=r.p+"assets/img/execonfig.8ab5bc3d.png"},267:function(t,e,r){t.exports=r.p+"assets/img/exe.985d8b95.png"},268:function(t,e,r){t.exports=r.p+"assets/img/log.20aedb4d.png"},269:function(t,e,r){t.exports=r.p+"assets/img/appregist.63976638.png"},270:function(t,e,r){t.exports=r.p+"assets/img/terminalregist.24811d65.png"},271:function(t,e,r){t.exports=r.p+"assets/img/terminalregist2.868f2ddf.png"},272:function(t,e,r){t.exports=r.p+"assets/img/terminalregist3.133ce4d2.png"},273:function(t,e,r){t.exports=r.p+"assets/img/wsdl.503ac7bd.png"},274:function(t,e,r){t.exports=r.p+"assets/img/token.952474bf.png"},275:function(t,e,r){t.exports=r.p+"assets/img/variableset.d4aa5d34.png"},276:function(t,e,r){t.exports=r.p+"assets/img/valitdata.dc5bed00.png"},384:function(t,e,r){"use strict";r.r(e);var a=r(2),i=Object(a.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"dxopc-ole-client使用说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client使用说明","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client使用说明")]),t._v(" "),a("p",[t._v("DXOPC_OLE_Client是以自动化接口方式取OPC内数据实时入库的工具。数据库支持SQL Server、Oracle。"),a("br"),t._v("\n入库方式有2种推荐第一种，环节越少使用越简单:")]),t._v(" "),a("ol",[a("li",[t._v("获取到的数据可以直接入目标库。")]),t._v(" "),a("li",[t._v("若目标库无法通过网络直接访问，使用配套webservice中转入库。")])]),t._v(" "),a("h2",{attrs:{id:"运行环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行环境","aria-hidden":"true"}},[t._v("#")]),t._v(" 运行环境")]),t._v(" "),a("p",[t._v(".NET4.0，百度网盘"),a("a",{attrs:{href:"https://pan.baidu.com/s/1AvCoP826CS9xipfSv-0aOw",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载"),a("OutboundLink")],1),t._v("，提取码：8yqp")]),t._v(" "),a("h2",{attrs:{id:"目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录结构","aria-hidden":"true"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),a("p",[t._v("主目录"),a("br"),t._v(" "),a("img",{attrs:{src:r(264),alt:"dic"}})]),t._v(" "),a("h2",{attrs:{id:"应用配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 应用配置")]),t._v(" "),a("h3",{attrs:{id:"opcitemsconfig-xml配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#opcitemsconfig-xml配置","aria-hidden":"true"}},[t._v("#")]),t._v(" OPCItemsConfig.xml配置")]),t._v(" "),a("p",[a("img",{attrs:{src:r(265),alt:"opcitemsconfig"}})]),t._v(" "),a("ol",[a("li",[t._v("OpcItems标签说明：\n"),a("ul",[a("li",[t._v("serverIp：OPC SERVER的IP")]),t._v(" "),a("li",[t._v("opcLibrary：OPC SERVER的服务标识"),a("br"),t._v(" "),a("strong",[t._v("这两个参数组态调试人员提供")])]),t._v(" "),a("li",[t._v("targetDbType：目标数据库类型，SQLSERVER或ORACLE")]),t._v(" "),a("li",[t._v("upstreamType：上层服务类型，DB或WebService。eg:直接入库的形式配DB")])])]),t._v(" "),a("li",[t._v("OpcItem标签说明：\n"),a("ul",[a("li",[t._v("clientHandle：客户端自定义变量标识，从1递增即可")]),t._v(" "),a("li",[t._v("itemId：服务端内部变量标识，"),a("strong",[t._v("组态调试人员提供")])]),t._v(" "),a("li",[t._v("itemValue：变量值")]),t._v(" "),a("li",[t._v("itemQuality：质量")]),t._v(" "),a("li",[t._v("itemTimeStamp：时间戳")]),t._v(" "),a("li",[t._v("dataType：数据类型标识，用于计算量，不需要的不用配置")]),t._v(" "),a("li",[t._v("dataType2：数据类型标识，用于计算量，不需要的不用配置")]),t._v(" "),a("li",[t._v("targetTable：目标表名")]),t._v(" "),a("li",[t._v("targetColumn： 目标列名")]),t._v(" "),a("li",[t._v("targetTablePk：目标表主键字段名，只支持单主键")]),t._v(" "),a("li",[t._v("targetPkValue：主键值")]),t._v(" "),a("li",[t._v("sjColumn：数据时间字段名"),a("br"),t._v(" "),a("strong",[t._v("OpcItem的配置可以从配置文件手动配，也可以从程序界面上配置。配置文件更改后需要重启程序。")])])])])]),t._v(" "),a("h3",{attrs:{id:"dxopcinteractive-exe-config配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dxopcinteractive-exe-config配置","aria-hidden":"true"}},[t._v("#")]),t._v(" DxOPCInteractive.exe.config配置")]),t._v(" "),a("p",[a("img",{attrs:{src:r(266),alt:"execonfig"}})]),t._v(" "),a("ol",[a("li",[t._v("connectionStrings：数据库连接配置，ConnectionString是SQL SERVER的配置，ConnectionString_ORACLE是ORACLE的配置")]),t._v(" "),a("li",[t._v("client：对应上层webservice的地址")])]),t._v(" "),a("h3",{attrs:{id:"界面应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#界面应用","aria-hidden":"true"}},[t._v("#")]),t._v(" 界面应用")]),t._v(" "),a("p",[a("img",{attrs:{src:r(267),alt:"exe"}}),a("br"),t._v("\nAddItem：增加变量"),a("br"),t._v("\nDeleteItem：删除变量"),a("br"),t._v("\n变量配置：直接更改相应属性，所在行失去焦点时自动保存"),a("br"),t._v("\n变量调试：Read、Write读写变量，Read时需要clientHandle参数，Write时需要itemValue参数"),a("br"),t._v("\neg：上图中配置了1个变量，从OPC服务中取aliasgroup1.TAG1的值，更新到a表中主键字段c值为d的记录的b字段上。")]),t._v(" "),a("h3",{attrs:{id:"日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日志","aria-hidden":"true"}},[t._v("#")]),t._v(" 日志")]),t._v(" "),a("p",[a("img",{attrs:{src:r(268),alt:"log"}}),a("br"),t._v("\n在bin目录同级，DxOPCInteractive_log.txt是日志文件")]),t._v(" "),a("h2",{attrs:{id:"配套webservice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配套webservice","aria-hidden":"true"}},[t._v("#")]),t._v(" 配套webservice")]),t._v(" "),a("ol",[a("li",[t._v("IIS内发布dataProcWebService服务，保证网络通信正常。")]),t._v(" "),a("li",[t._v("Web.config配置目标数据库连接字符串，ConnectionString是SQL SERVER的配置，OraConnectionString是ORACLE的配置。")]),t._v(" "),a("li",[t._v("浏览器内访问服务地址没有报错，一般就是正常的。")])]),t._v(" "),a("h2",{attrs:{id:"dxopc-ole-client2-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client2-0","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client2.0")]),t._v(" "),a("p",[t._v("2.0版本是取OPC数据入前置机服务的专用版本。DXOPC_OLE_Client2.0以上内容是1.0版本配置说明。")]),t._v(" "),a("h3",{attrs:{id:"前置机上注册应用和虚拟终端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前置机上注册应用和虚拟终端","aria-hidden":"true"}},[t._v("#")]),t._v(" 前置机上注册应用和虚拟终端")]),t._v(" "),a("ol",[a("li",[t._v("应用注册"),a("br"),t._v("\n共享交换->应用注册->新增"),a("br"),t._v(" "),a("img",{attrs:{src:r(269),alt:"appregist"}})]),t._v(" "),a("li",[t._v("虚拟终端注册"),a("br"),t._v("\n终端管理->注册终端->注册"),a("br"),t._v(" "),a("img",{attrs:{src:r(270),alt:"terminalregist"}}),a("br"),t._v("\n定位"),a("br"),t._v(" "),a("img",{attrs:{src:r(271),alt:"terminalregist2"}}),a("br"),t._v("\n终端列表"),a("br"),t._v(" "),a("img",{attrs:{src:r(272),alt:"terminalregist3"}})])]),t._v(" "),a("h3",{attrs:{id:"dxopc-ole-client接口配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client接口配置","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client接口配置")]),t._v(" "),a("ol",[a("li",[t._v("wsdl配置"),a("br"),t._v(" "),a("img",{attrs:{src:r(273),alt:"wsdl"}}),a("br"),t._v("\n如图DxOPCInteractive.exe.config中地址改成前置机数据服务地址。")]),t._v(" "),a("li",[t._v("上层服务类型和token配置"),a("br"),t._v("\nupstreamType：上层服务类型，配置WSDL。"),a("br"),t._v(" "),a("img",{attrs:{src:r(274),alt:"token"}}),a("br"),t._v("\nOpcItems标签上token是应用注册中生成的认证KEY。serverIp和opcLibrary参考1.0版本OpcItems标签说明，其它的无需配置。")])]),t._v(" "),a("h3",{attrs:{id:"dxopc-ole-client变量配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client变量配置","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client变量配置")]),t._v(" "),a("p",[t._v("OpcItem标签中devid和IoType是2.0中新增属性，也是必须配置属性。分别对应前置机中注册的终端编号和变量类型。clientHandle和itemId参考1.0中配置，这2个属性也是必须配置属性。"),a("br"),t._v(" "),a("strong",[t._v("IoType推荐从客户端界面上选择配置，不容出错。注意前置机中每个虚拟终端支持的变量数是有限的，对应的IoType也是有限的，遥信(数字量)单终端20个。一个工程可能需要添加多个虚拟终端。")]),a("br"),t._v(" "),a("strong",[t._v("IoType如果要从配置文件配置，配置值请参考：前置机监测元素编码表2.0.xls")]),a("br"),t._v(" "),a("img",{attrs:{src:r(275),alt:"variableset"}})]),t._v(" "),a("h3",{attrs:{id:"前置机上验证结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前置机上验证结果","aria-hidden":"true"}},[t._v("#")]),t._v(" 前置机上验证结果")]),t._v(" "),a("p",[t._v("配置完重启客户端，前置机中查看虚拟终端对应的数据是否更新。"),a("br"),t._v(" "),a("img",{attrs:{src:r(276),alt:"valitdata"}})])])},[],!1,null,null,null);e.default=i.exports}}]);