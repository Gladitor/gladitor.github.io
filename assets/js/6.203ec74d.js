(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{288:function(t,e,a){t.exports=a.p+"assets/img/dic.2bc6e02a.png"},289:function(t,e,a){t.exports=a.p+"assets/img/opcitemsconfig.b6ea3aa0.png"},290:function(t,e,a){t.exports=a.p+"assets/img/execonfig.8ab5bc3d.png"},291:function(t,e,a){t.exports=a.p+"assets/img/exe.985d8b95.png"},292:function(t,e,a){t.exports=a.p+"assets/img/log.20aedb4d.png"},293:function(t,e,a){t.exports=a.p+"assets/img/appregist.63976638.png"},294:function(t,e,a){t.exports=a.p+"assets/img/terminalregist.24811d65.png"},295:function(t,e,a){t.exports=a.p+"assets/img/terminalregist2.868f2ddf.png"},296:function(t,e,a){t.exports=a.p+"assets/img/terminalregist3.133ce4d2.png"},297:function(t,e,a){t.exports=a.p+"assets/img/wsdl.503ac7bd.png"},298:function(t,e,a){t.exports=a.p+"assets/img/token.952474bf.png"},299:function(t,e,a){t.exports=a.p+"assets/img/variableset.d4aa5d34.png"},300:function(t,e,a){t.exports=a.p+"assets/img/valitdata.dc5bed00.png"},395:function(t,e,a){"use strict";a.r(e);var r=a(2),i=Object(r.a)({},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"dxopc-ole-client使用说明"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client使用说明","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client使用说明")]),t._v(" "),r("p",[t._v("DXOPC_OLE_Client是以自动化接口方式取OPC内数据实时入库的工具。数据库支持SQL Server、Oracle。"),r("br"),t._v("\n入库方式有2种推荐第一种，环节越少使用越简单:")]),t._v(" "),r("ol",[r("li",[t._v("获取到的数据可以直接入目标库。")]),t._v(" "),r("li",[t._v("若目标库无法通过网络直接访问，使用配套webservice中转入库。")])]),t._v(" "),r("h2",{attrs:{id:"运行环境"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#运行环境","aria-hidden":"true"}},[t._v("#")]),t._v(" 运行环境")]),t._v(" "),r("p",[t._v(".NET4.0，百度网盘"),r("a",{attrs:{href:"https://pan.baidu.com/s/1AvCoP826CS9xipfSv-0aOw",target:"_blank",rel:"noopener noreferrer"}},[t._v("下载"),r("OutboundLink")],1),t._v("，提取码：8yqp")]),t._v(" "),r("h2",{attrs:{id:"目录结构"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#目录结构","aria-hidden":"true"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),r("p",[t._v("主目录"),r("br"),t._v(" "),r("img",{attrs:{src:a(288),alt:"dic"}})]),t._v(" "),r("h2",{attrs:{id:"应用配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#应用配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 应用配置")]),t._v(" "),r("h3",{attrs:{id:"opcitemsconfig-xml配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#opcitemsconfig-xml配置","aria-hidden":"true"}},[t._v("#")]),t._v(" OPCItemsConfig.xml配置")]),t._v(" "),r("p",[r("img",{attrs:{src:a(289),alt:"opcitemsconfig"}})]),t._v(" "),r("ol",[r("li",[t._v("OpcItems标签说明：\n"),r("ul",[r("li",[t._v("serverIp：OPC SERVER的IP")]),t._v(" "),r("li",[t._v("opcLibrary：OPC SERVER的服务标识"),r("br"),t._v(" "),r("strong",[t._v("这两个参数组态调试人员提供")])]),t._v(" "),r("li",[t._v("targetDbType：目标数据库类型，SQLSERVER或ORACLE")]),t._v(" "),r("li",[t._v("upstreamType：上层服务类型，DB或WebService。eg:直接入库的形式配DB")])])]),t._v(" "),r("li",[t._v("OpcItem标签说明：\n"),r("ul",[r("li",[t._v("clientHandle：客户端自定义变量标识，从1递增即可")]),t._v(" "),r("li",[t._v("itemId：服务端内部变量标识，"),r("strong",[t._v("组态调试人员提供")])]),t._v(" "),r("li",[t._v("itemValue：变量值")]),t._v(" "),r("li",[t._v("itemQuality：质量")]),t._v(" "),r("li",[t._v("itemTimeStamp：时间戳")]),t._v(" "),r("li",[t._v("dataType：数据类型标识，用于计算量，不需要的不用配置")]),t._v(" "),r("li",[t._v("dataType2：数据类型标识，用于计算量，不需要的不用配置")]),t._v(" "),r("li",[t._v("targetTable：目标表名")]),t._v(" "),r("li",[t._v("targetColumn： 目标列名")]),t._v(" "),r("li",[t._v("targetTablePk：目标表主键字段名，只支持单主键")]),t._v(" "),r("li",[t._v("targetPkValue：主键值")]),t._v(" "),r("li",[t._v("sjColumn：数据时间字段名"),r("br"),t._v(" "),r("strong",[t._v("OpcItem的配置可以从配置文件手动配，也可以从程序界面上配置。配置文件更改后需要重启程序。")])])])])]),t._v(" "),r("h3",{attrs:{id:"dxopcinteractive-exe-config配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dxopcinteractive-exe-config配置","aria-hidden":"true"}},[t._v("#")]),t._v(" DxOPCInteractive.exe.config配置")]),t._v(" "),r("p",[r("img",{attrs:{src:a(290),alt:"execonfig"}})]),t._v(" "),r("ol",[r("li",[t._v("connectionStrings：数据库连接配置，ConnectionString是SQL SERVER的配置，ConnectionString_ORACLE是ORACLE的配置")]),t._v(" "),r("li",[t._v("client：对应上层webservice的地址")])]),t._v(" "),r("h3",{attrs:{id:"界面应用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#界面应用","aria-hidden":"true"}},[t._v("#")]),t._v(" 界面应用")]),t._v(" "),r("p",[r("img",{attrs:{src:a(291),alt:"exe"}}),r("br"),t._v("\nAddItem：增加变量"),r("br"),t._v("\nDeleteItem：删除变量"),r("br"),t._v("\n变量配置：直接更改相应属性，所在行失去焦点时自动保存"),r("br"),t._v("\n变量调试：Read、Write读写变量，Read时需要clientHandle参数，Write时需要itemValue参数"),r("br"),t._v("\neg：上图中配置了1个变量，从OPC服务中取aliasgroup1.TAG1的值，更新到a表中主键字段c值为d的记录的b字段上。")]),t._v(" "),r("h3",{attrs:{id:"日志"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#日志","aria-hidden":"true"}},[t._v("#")]),t._v(" 日志")]),t._v(" "),r("p",[r("img",{attrs:{src:a(292),alt:"log"}}),r("br"),t._v("\n在bin目录同级，DxOPCInteractive_log.txt是日志文件")]),t._v(" "),r("h2",{attrs:{id:"配套webservice"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#配套webservice","aria-hidden":"true"}},[t._v("#")]),t._v(" 配套webservice")]),t._v(" "),r("ol",[r("li",[t._v("IIS内发布dataProcWebService服务，保证网络通信正常。")]),t._v(" "),r("li",[t._v("Web.config配置目标数据库连接字符串，ConnectionString是SQL SERVER的配置，OraConnectionString是ORACLE的配置。")]),t._v(" "),r("li",[t._v("浏览器内访问服务地址没有报错，一般就是正常的。")])]),t._v(" "),r("h2",{attrs:{id:"dxopc-ole-client2-0"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client2-0","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client2.0")]),t._v(" "),r("p",[t._v("2.0版本是取OPC数据入前置机服务的专用版本。DXOPC_OLE_Client2.0以上内容是1.0版本配置说明。")]),t._v(" "),r("h3",{attrs:{id:"前置机上注册应用和虚拟终端"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#前置机上注册应用和虚拟终端","aria-hidden":"true"}},[t._v("#")]),t._v(" 前置机上注册应用和虚拟终端"),r("a",{attrs:{id:"前置机上注册应用和虚拟终端"}})]),t._v(" "),r("ol",[r("li",[t._v("应用注册"),r("br"),t._v("\n共享交换->应用注册->新增"),r("br"),t._v(" "),r("img",{attrs:{src:a(293),alt:"appregist"}})]),t._v(" "),r("li",[t._v("虚拟终端注册"),r("br"),t._v("\n终端管理->注册终端->注册"),r("br"),t._v(" "),r("img",{attrs:{src:a(294),alt:"terminalregist"}}),r("br"),t._v("\n定位"),r("br"),t._v(" "),r("img",{attrs:{src:a(295),alt:"terminalregist2"}}),r("br"),t._v("\n终端列表"),r("br"),t._v(" "),r("img",{attrs:{src:a(296),alt:"terminalregist3"}})])]),t._v(" "),r("h3",{attrs:{id:"dxopc-ole-client接口配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client接口配置","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client接口配置"),r("a",{attrs:{id:"DXOPC_OLE_Client接口配置"}})]),t._v(" "),r("ol",[r("li",[t._v("wsdl配置"),r("br"),t._v(" "),r("img",{attrs:{src:a(297),alt:"wsdl"}}),r("br"),t._v("\n如图DxOPCInteractive.exe.config中地址改成前置机数据服务地址。")]),t._v(" "),r("li",[t._v("上层服务类型和token配置"),r("br"),t._v("\nupstreamType：上层服务类型，配置WSDL。"),r("br"),t._v(" "),r("img",{attrs:{src:a(298),alt:"token"}}),r("br"),t._v("\nOpcItems标签上token是应用注册中生成的认证KEY。serverIp和opcLibrary参考1.0版本OpcItems标签说明，其它的无需配置。")])]),t._v(" "),r("h3",{attrs:{id:"dxopc-ole-client变量配置"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client变量配置","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client变量配置")]),t._v(" "),r("p",[t._v("OpcItem标签中devid和IoType是2.0中新增属性，也是必须配置属性。分别对应前置机中注册的终端编号和变量类型。clientHandle和itemId参考1.0中配置，这2个属性也是必须配置属性。"),r("br"),t._v(" "),r("strong",[t._v("IoType推荐从客户端界面上选择配置，不容出错。注意前置机中每个虚拟终端支持的变量数是有限的，对应的IoType也是有限的，遥信(数字量)单终端20个。一个工程可能需要添加多个虚拟终端。")]),r("br"),t._v(" "),r("strong",[t._v("IoType如果要从配置文件配置，配置值请参考：前置机监测元素编码表2.0.xls")]),r("br"),t._v(" "),r("img",{attrs:{src:a(299),alt:"variableset"}})]),t._v(" "),r("h3",{attrs:{id:"前置机上验证结果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#前置机上验证结果","aria-hidden":"true"}},[t._v("#")]),t._v(" 前置机上验证结果")]),t._v(" "),r("p",[t._v("配置完重启客户端，前置机中查看虚拟终端对应的数据是否更新。"),r("br"),t._v(" "),r("img",{attrs:{src:a(300),alt:"valitdata"}})]),t._v(" "),r("h2",{attrs:{id:"dxopc-ole-client3-0"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client3-0","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client3.0")]),t._v(" "),r("p",[t._v("3.0版本也是取OPC数据入前置机服务的专用版本。与2.0的区别是没有进行数据格式化，以OPC原始数据格式全量入库，免去客户端的配置工作。")]),t._v(" "),r("h3",{attrs:{id:"前置机上注册应用和虚拟终端-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#前置机上注册应用和虚拟终端-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 前置机上注册应用和虚拟终端")]),t._v(" "),r("p",[t._v("参考"),r("a",{attrs:{href:"#%E5%89%8D%E7%BD%AE%E6%9C%BA%E4%B8%8A%E6%B3%A8%E5%86%8C%E5%BA%94%E7%94%A8%E5%92%8C%E8%99%9A%E6%8B%9F%E7%BB%88%E7%AB%AF"}},[t._v("2.0相应配置")])]),t._v(" "),r("h3",{attrs:{id:"dxopc-ole-client接口配置-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#dxopc-ole-client接口配置-2","aria-hidden":"true"}},[t._v("#")]),t._v(" DXOPC_OLE_Client接口配置")]),t._v(" "),r("p",[t._v("参考"),r("a",{attrs:{href:"#DXOPC_OLE_Client%E6%8E%A5%E5%8F%A3%E9%85%8D%E7%BD%AE"}},[t._v("2.0相应配置")]),r("br"),t._v(" "),r("strong",[t._v("不同之处是OpcItems标签新增一个tmcode属性，对应的是前置机中注册的终端编号。终端号用于区分组态系统，一个组态系统对应一个终端号。")]),r("br"),t._v(" "),r("strong",[t._v("无需手动配置变量")])])])},[],!1,null,null,null);e.default=i.exports}}]);