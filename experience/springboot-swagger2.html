<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>springboot-shiro项目集成swagger2 | Jiay</title>
    <meta name="description" content="welcome!">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.7be88f66.css" as="style"><link rel="preload" href="/assets/js/app.85f4e3f6.js" as="script"><link rel="preload" href="/assets/js/2.6a5ced42.js" as="script"><link rel="preload" href="/assets/js/18.39e95760.js" as="script"><link rel="preload" href="/assets/js/15.aea2f4f6.js" as="script"><link rel="prefetch" href="/assets/js/10.a1398559.js"><link rel="prefetch" href="/assets/js/11.74b5ded6.js"><link rel="prefetch" href="/assets/js/12.e0cdf75b.js"><link rel="prefetch" href="/assets/js/13.4266d107.js"><link rel="prefetch" href="/assets/js/14.b59a8717.js"><link rel="prefetch" href="/assets/js/16.80269489.js"><link rel="prefetch" href="/assets/js/17.fee383fa.js"><link rel="prefetch" href="/assets/js/19.6b521032.js"><link rel="prefetch" href="/assets/js/20.d2f922c0.js"><link rel="prefetch" href="/assets/js/21.bc610173.js"><link rel="prefetch" href="/assets/js/22.ae963ba1.js"><link rel="prefetch" href="/assets/js/23.aec25c99.js"><link rel="prefetch" href="/assets/js/24.6c36c9af.js"><link rel="prefetch" href="/assets/js/25.94affe8d.js"><link rel="prefetch" href="/assets/js/26.475275ee.js"><link rel="prefetch" href="/assets/js/27.b9254691.js"><link rel="prefetch" href="/assets/js/28.8527c990.js"><link rel="prefetch" href="/assets/js/29.66196d41.js"><link rel="prefetch" href="/assets/js/3.94d45f1a.js"><link rel="prefetch" href="/assets/js/30.dafc0d7d.js"><link rel="prefetch" href="/assets/js/31.46462006.js"><link rel="prefetch" href="/assets/js/32.ad3c01ef.js"><link rel="prefetch" href="/assets/js/33.e777f2ae.js"><link rel="prefetch" href="/assets/js/34.df5b8d55.js"><link rel="prefetch" href="/assets/js/35.7df3a28b.js"><link rel="prefetch" href="/assets/js/4.062d7f33.js"><link rel="prefetch" href="/assets/js/5.8d5878e9.js"><link rel="prefetch" href="/assets/js/6.62d19643.js"><link rel="prefetch" href="/assets/js/7.e4a0dfc9.js"><link rel="prefetch" href="/assets/js/8.931eb5e5.js"><link rel="prefetch" href="/assets/js/9.e8abd07b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7be88f66.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jiay</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/about/" class="sidebar-link">about</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>exp</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/experience/" class="sidebar-link">something funny</a></li><li><a href="/experience/webservice.html" class="sidebar-link">Cxf实现webservice实战入门</a></li><li><a href="/experience/gRPC.html" class="sidebar-link">gRPC实战总结</a></li><li><a href="/experience/liquibase.html" class="sidebar-link">liquibase实战</a></li><li><a href="/experience/transaction.html" class="sidebar-link">事务</a></li><li><a href="/experience/springboot-swagger2.html" class="active sidebar-link">springboot-shiro项目集成swagger2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/experience/springboot-swagger2.html#依赖" class="sidebar-link">依赖</a></li><li class="sidebar-sub-header"><a href="/experience/springboot-swagger2.html#swagger2配置类" class="sidebar-link">swagger2配置类</a></li><li class="sidebar-sub-header"><a href="/experience/springboot-swagger2.html#shiro配置" class="sidebar-link">shiro配置</a></li><li class="sidebar-sub-header"><a href="/experience/springboot-swagger2.html#issue" class="sidebar-link">ISSUE</a></li><li class="sidebar-sub-header"><a href="/experience/springboot-swagger2.html#shiro通配符说明" class="sidebar-link">shiro通配符说明</a></li></ul></li><li><a href="/experience/datax.html" class="sidebar-link">DataX --alibaba</a></li><li><a href="/experience/fiddler-nox.html" class="sidebar-link">fiddler+nox对android抓包实战</a></li><li><a href="/experience/xxnet.html" class="sidebar-link">xx-net科学上网教程</a></li><li><a href="/experience/rsyncforwindows.html" class="sidebar-link">rsync在windows下应用免费版</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>etd</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>issues</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>life</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="springboot-shiro项目集成swagger2"><a href="#springboot-shiro项目集成swagger2" aria-hidden="true" class="header-anchor">#</a> springboot-shiro项目集成swagger2</h1> <p>集成版本:</p> <ul><li>SpringBoot: 2.1.6.RELEASE</li> <li>Shiro: 1.4.0</li> <li>Swagger2: 2.8.0</li></ul> <p><img src="/assets/img/init.26407cc4.png" alt="swagger"></p> <h2 id="依赖"><a href="#依赖" aria-hidden="true" class="header-anchor">#</a> 依赖</h2> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- shiro --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;
    &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt;
    &lt;version&gt;1.4.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.crazycake&lt;/groupId&gt;
    &lt;artifactId&gt;shiro-redis&lt;/artifactId&gt;
    &lt;version&gt;3.2.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.github.theborakompanioni&lt;/groupId&gt;
    &lt;artifactId&gt;thymeleaf-extras-shiro&lt;/artifactId&gt;
    &lt;version&gt;2.0.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- swagger --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.springfox&lt;/groupId&gt;
    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
    &lt;version&gt;2.8.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.springfox&lt;/groupId&gt;
    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
    &lt;version&gt;2.8.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div><h2 id="swagger2配置类"><a href="#swagger2配置类" aria-hidden="true" class="header-anchor">#</a> swagger2配置类</h2> <div class="language- extra-class"><pre class="language-text"><code>@EnableSwagger2
public class Swagger2Config {
    @Bean
    public Docket api(){
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                .apis(RequestHandlerSelectors.basePackage(&quot;com.jiay.autho&quot;))
                .paths(PathSelectors.any())
                .build();
    }

    private ApiInfo apiInfo(){
        return new ApiInfoBuilder()
                .title(&quot;Autho-api文档&quot;)
                .description(&quot;权限系统api文档&quot;)
                //服务条款网址
                .termsOfServiceUrl(&quot;&quot;)
                .version(&quot;1.0&quot;)
                .contact(new Contact(&quot;JIAY&quot;,&quot;https://gladitor.github.io/myblog/&quot;,&quot;eicool110@outlook.com&quot;))
                .build();
    }
}
</code></pre></div><h2 id="shiro配置"><a href="#shiro配置" aria-hidden="true" class="header-anchor">#</a> shiro配置</h2> <p>shiro中添加swagger的放行,否则无法访问swagger-ui.html</p> <div class="language- extra-class"><pre class="language-text"><code>//swagger放行配置
filterChainDefinitionMap.put(&quot;/swagger-ui.html&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/swagger/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/swagger-resources/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/v2/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/webjars/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/configuration/**&quot;, &quot;anon&quot;);
//必须加以下配置，否则无法正常访问swagger中接口内容
filterChainDefinitionMap.put(&quot;/configuration/security&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/configuration/ui&quot;, &quot;anon&quot;);
</code></pre></div><h2 id="issue"><a href="#issue" aria-hidden="true" class="header-anchor">#</a> ISSUE</h2> <p>按上面配置可正常访问swagger-ui.html，并能正常使用swagger。<br>
下面列出swagger集成中配到的几个问题：</p> <ul><li>Unable to infer base url.<br>
原因是shiro放行中配置不对，需要按【//swagger放行配置】处配置。</li> <li>按网上的常规配置后能访问swagger-ui.html但接口内容无法正常查看及测试<br>
原因是shiro放行配置不完全，需要加上实例中shiro放行配置最后两行。关于这两行有疑问的朋友参考下面shiro通配符说明。</li></ul> <h2 id="shiro通配符说明"><a href="#shiro通配符说明" aria-hidden="true" class="header-anchor">#</a> shiro通配符说明</h2> <p>?　　匹配单个字符，正确路径/admin, 那么/admin?=authc可以匹配admin + 单个字符，admin12就不能匹配</p> <p>*　　能匹配任意字符，admin，admin1, admin12, 都可以匹配，多层路径不能匹配，比如admin12/12</p> <p>**　 匹配多层路径，admin/**　　能匹配admin/1222/12112...., 但是admin12/1545不能匹配</p> <div><h2>欢迎来访</h2> <ul><li>有问题欢迎留言或加交流qq群:934022738</li> <li>转载请注明出处</li> <li>请小编喝茶~<br><img src="/assets/img/wx.dc92fb1a.png"></li></ul></div> <!----></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/experience/transaction.html" class="prev">
          事务
        </a></span> <span class="next"><a href="/experience/datax.html">
          DataX --alibaba
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.85f4e3f6.js" defer></script><script src="/assets/js/2.6a5ced42.js" defer></script><script src="/assets/js/18.39e95760.js" defer></script><script src="/assets/js/15.aea2f4f6.js" defer></script>
  </body>
</html>
