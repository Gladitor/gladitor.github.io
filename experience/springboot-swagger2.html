<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>springboot-shiro项目集成swagger2 | Jiay</title>
    <meta name="description" content="不忘初心">
    <link rel="icon" href="/myblog/favicon.ico">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.94708bcb.css" as="style"><link rel="preload" href="/myblog/assets/js/app.e069e9ed.js" as="script"><link rel="preload" href="/myblog/assets/js/6.d7584087.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.ad28ae33.js"><link rel="prefetch" href="/myblog/assets/js/11.a1f62c00.js"><link rel="prefetch" href="/myblog/assets/js/12.d89f9bde.js"><link rel="prefetch" href="/myblog/assets/js/13.58bba48b.js"><link rel="prefetch" href="/myblog/assets/js/14.5afa5faa.js"><link rel="prefetch" href="/myblog/assets/js/15.88eff212.js"><link rel="prefetch" href="/myblog/assets/js/16.46d65706.js"><link rel="prefetch" href="/myblog/assets/js/2.b9570719.js"><link rel="prefetch" href="/myblog/assets/js/3.1d7764ce.js"><link rel="prefetch" href="/myblog/assets/js/4.1a958b52.js"><link rel="prefetch" href="/myblog/assets/js/5.7dd1ff32.js"><link rel="prefetch" href="/myblog/assets/js/7.15f31758.js"><link rel="prefetch" href="/myblog/assets/js/8.9b603492.js"><link rel="prefetch" href="/myblog/assets/js/9.c124878b.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.94708bcb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><!----> <span class="site-name">Jiay</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/about/" class="nav-link">About</a></li><li class="dropdown-item"><!----> <a href="/myblog/experience/" class="nav-link router-link-active">Experience</a></li><li class="dropdown-item"><!----> <a href="/myblog/enterthedoor/" class="nav-link">Enterthedoor</a></li><li class="dropdown-item"><!----> <a href="/myblog/read/" class="nav-link">Read</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Blog</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/about/" class="nav-link">About</a></li><li class="dropdown-item"><!----> <a href="/myblog/experience/" class="nav-link router-link-active">Experience</a></li><li class="dropdown-item"><!----> <a href="/myblog/enterthedoor/" class="nav-link">Enterthedoor</a></li><li class="dropdown-item"><!----> <a href="/myblog/read/" class="nav-link">Read</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/myblog/experience/datax.html" class="sidebar-link">DataX --alibaba</a></li><li><a href="/myblog/experience/springboot-swagger2.html" class="active sidebar-link">springboot-shiro项目集成swagger2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myblog/experience/springboot-swagger2.html#依赖" class="sidebar-link">依赖</a></li><li class="sidebar-sub-header"><a href="/myblog/experience/springboot-swagger2.html#swagger2配置类" class="sidebar-link">swagger2配置类</a></li><li class="sidebar-sub-header"><a href="/myblog/experience/springboot-swagger2.html#shiro配置" class="sidebar-link">shiro配置</a></li><li class="sidebar-sub-header"><a href="/myblog/experience/springboot-swagger2.html#issue" class="sidebar-link">ISSUE</a></li><li class="sidebar-sub-header"><a href="/myblog/experience/springboot-swagger2.html#shiro通配符说明" class="sidebar-link">shiro通配符说明</a></li></ul></li><li><a href="/myblog/experience/gRPC.html" class="sidebar-link">gRPC实战总结</a></li><li><a href="/myblog/experience/thingsboard.html" class="sidebar-link">thingsboard</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="springboot-shiro项目集成swagger2"><a href="#springboot-shiro项目集成swagger2" aria-hidden="true" class="header-anchor">#</a> springboot-shiro项目集成swagger2</h1> <p>集成版本:</p> <ul><li>SpringBoot: 2.1.6.RELEASE</li> <li>Shiro: 1.4.0</li> <li>Swagger2: 2.8.0</li></ul> <p><img src="/myblog/assets/img/init.863bbdd7.png" alt="swagger"></p> <h2 id="依赖"><a href="#依赖" aria-hidden="true" class="header-anchor">#</a> 依赖</h2> <div class="language- extra-class"><pre class="language-text"><code>&lt;!-- shiro --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;
    &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt;
    &lt;version&gt;1.4.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.crazycake&lt;/groupId&gt;
    &lt;artifactId&gt;shiro-redis&lt;/artifactId&gt;
    &lt;version&gt;3.2.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.github.theborakompanioni&lt;/groupId&gt;
    &lt;artifactId&gt;thymeleaf-extras-shiro&lt;/artifactId&gt;
    &lt;version&gt;2.0.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- swagger --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.springfox&lt;/groupId&gt;
    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
    &lt;version&gt;2.8.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.springfox&lt;/groupId&gt;
    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
    &lt;version&gt;2.8.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div><h2 id="swagger2配置类"><a href="#swagger2配置类" aria-hidden="true" class="header-anchor">#</a> swagger2配置类</h2> <div class="language- extra-class"><pre class="language-text"><code>@EnableSwagger2
public class Swagger2Config {
    @Bean
    public Docket api(){
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .select()
                .apis(RequestHandlerSelectors.basePackage(&quot;com.jiay.autho&quot;))
                .paths(PathSelectors.any())
                .build();
    }

    private ApiInfo apiInfo(){
        return new ApiInfoBuilder()
                .title(&quot;Autho-api文档&quot;)
                .description(&quot;权限系统api文档&quot;)
                //服务条款网址
                .termsOfServiceUrl(&quot;&quot;)
                .version(&quot;1.0&quot;)
                .contact(new Contact(&quot;JIAY&quot;,&quot;https://gladitor.github.io/myblog/&quot;,&quot;eicool110@outlook.com&quot;))
                .build();
    }
}
</code></pre></div><h2 id="shiro配置"><a href="#shiro配置" aria-hidden="true" class="header-anchor">#</a> shiro配置</h2> <p>shiro中添加swagger的放行,否则无法访问swagger-ui.html</p> <div class="language- extra-class"><pre class="language-text"><code>//swagger放行配置
filterChainDefinitionMap.put(&quot;/swagger-ui.html&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/swagger/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/swagger-resources/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/v2/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/webjars/**&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/configuration/**&quot;, &quot;anon&quot;);
//必须加以下配置，否则无法正常访问swagger中接口内容
filterChainDefinitionMap.put(&quot;/configuration/security&quot;, &quot;anon&quot;);
filterChainDefinitionMap.put(&quot;/configuration/ui&quot;, &quot;anon&quot;);
</code></pre></div><h2 id="issue"><a href="#issue" aria-hidden="true" class="header-anchor">#</a> ISSUE</h2> <p>按上面配置可正常访问swagger-ui.html，并能正常使用swagger。<br>
下面列出swagger集成中配到的几个问题：</p> <ul><li>Unable to infer base url.<br>
原因是shiro放行中配置不对，需要按【//swagger放行配置】处配置。</li> <li>按网上的常规配置后能访问swagger-ui.html但接口内容无法正常查看及测试<br>
原因是shiro放行配置不完全，需要加上实例中shiro放行配置最后两行。关于这两行有疑问的朋友参考下面shiro通配符说明。</li></ul> <h2 id="shiro通配符说明"><a href="#shiro通配符说明" aria-hidden="true" class="header-anchor">#</a> shiro通配符说明</h2> <p>?　　匹配单个字符，正确路径/admin, 那么/admin?=authc可以匹配admin + 单个字符，admin12就不能匹配</p> <p>*　　能匹配任意字符，admin，admin1, admin12, 都可以匹配，多层路径不能匹配，比如admin12/12</p> <p>**　 匹配多层路径，admin/**　　能匹配admin/1222/12112...., 但是admin12/1545不能匹配</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/myblog/experience/datax.html" class="prev">
          DataX --alibaba
        </a></span> <span class="next"><a href="/myblog/experience/gRPC.html">
          gRPC实战总结
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/myblog/assets/js/app.e069e9ed.js" defer></script><script src="/myblog/assets/js/6.d7584087.js" defer></script>
  </body>
</html>
